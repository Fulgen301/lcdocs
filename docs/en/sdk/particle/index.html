<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<link rel="stylesheet" type="text/css" href="../../doku.css">
<title>Particle</title>
<?php 
  $g_page_language = 'english';
  require_once('../../../webnotes/core/api.php');
  pwn_head();
?><script type="text/javascript">
  function switchLanguage() {
    var loc = window.location.href;
    if (loc.match(/\/en\//)) loc = loc.replace(/\/en\//, "/de/");
    else loc = loc.replace(/\/de\//, "/en/");
    window.location = loc;
  }
</script>
</head>
<body>
<ul class="nav">
<li class="fineprint">Clonk Developer Mode Documentation</li>
<li class="switchlang"><a href="javascript:switchLanguage()"><img src="/deco/dco_de_sml.gif" alt="German" border="0"></a></li>
<li><a href="../../sdk/index.html">Introduction</a></li>
<li><a href="../../content.html">Contents</a></li>
<li><a href="../../search.php">Search</a></li>
<li><a href="../../sdk/console.html">Engine</a></li>
<li><a href="../../sdk/cmdline.html">Command Line</a></li>
<li><a href="../../sdk/files.html">Game Data</a></li>
<li><a href="../../sdk/script/index.html">Script</a></li>
</ul>


<h1 id="Partikel">Particle</h1>

	<div class="text">Particles are lightweight objects which are not synchronized in a network game. This means that on the one hand you can create huge amounts of particles without slowing down the game too much but on the other hand there are only limited options for control of particle behaviour. If the particles are not sufficient for a given effect you have in mind, you can always use true objects instead.</div>
	<div class="text">If a particle is defined in a c4d group, any object definition located in the same group is ignored. This used to be a way to allow loading of placeholder options in the old graphics system which didn't support particles.</div>
	<div class="text">Particles are not stored in savegames and are designed for temporary visual effects only.</div>
	
	<h2 id="PartikelKomponentenC4D">Particle Components (c4d)</h2>
	<dl>
<dt>
<img src="../../images/icon_text.gif" width="16" height="16">Particle.txt</dt>
<dd>
			<div class="text">Particle properties.</div>
		</dd>
<dt id="Graphicspng">
<img src="../../images/icon_image.gif" width="16" height="16">Graphics.png</dt>
<dd>
			<div class="text">Particle graphics.</div>
			<div class="text">The particle definition can also contain the known components of <a href="../../sdk/definition/index.html">object definitions</a> for describing the particle (e.g. Title.png, DescDE/US.txt, etc.)</div>
		</dd>
</dl>
	
	<h2 id="Particletxt">Particle.txt</h2>
	<div class="text">This component contains the properties of the particle - as <a href="../../sdk/definition/defcore.html">DefCore.txt</a> does for <a href="../../sdk/definition/index.html">object definitions</a>.</div>
	<div class="text"><table>
<caption id="SektionDefCore">Section [Particle]</caption>
<thead><tr>
<th>Value</th>
<th>Data type</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr>
<td>Name</td>
<td>String (max. 30 chars)</td>
<td>Name of the particle definition. This name is also used to refer to this particle type in scripts. For multi-language display in the menu system you should use the Names.txt component.</td>
</tr>
<tr class="dark">
<td>MaxCount</td>
<td>Integer</td>
<td>Maximum number of instances of this particle type. See <a href="#maxcount">instance control</a>.</td>
</tr>
<tr>
<td>MinLifetime</td>
<td>Integer</td>
<td>Only for smoke particles: lower limit for the lifetime, which ranges from MinLifetime to MaxLifetime.</td>
</tr>
<tr class="dark">
<td>MaxLifetime</td>
<td>Integer</td>
<td>Only for smoke particles: upper limit for the lifetime, which ranges from MinLifetime to MaxLifetime.</td>
</tr>
<tr>
<td>InitFn</td>
<td>String (max. 30 chars)</td>
<td>Identifier for the function used to initialize the particle. For valid functions see section <a href="#funcs">particle functions</a>.</td>
</tr>
<tr class="dark">
<td>ExecFn</td>
<td>String (max. 30 chars)</td>
<td>Identifier for the function used to execute the particle each frame. For valid functions see section <a href="#funcs">particle functions</a>.</td>
</tr>
<tr>
<td>DrawFn</td>
<td>String (max. 30 chars)</td>
<td>Identifier for the function used to draw the particle. For valid functions see section <a href="#drawfuncs">drawing functions</a>.</td>
</tr>
<tr class="dark">
<td>CollisionFn</td>
<td>String (max. 30 chars)</td>
<td>Identifier for the function called upon collision with the landscape. Also see <a href="#collision">collision checking</a>.</td>
</tr>
<tr>
<td>Face</td>
<td>6 integers</td>
<td>Target rectangle for the graphics within Graphics.png. See <a href="#face">particle graphics</a>.</td>
</tr>
<tr class="dark">
<td>YOff</td>
<td>Integer</td>
<td>Upper spatial limit for the particle. At this limit the particles will be deleted as if the landscape would end here. Only StdExec.</td>
</tr>
<tr>
<td>Delay</td>
<td>Integer</td>
<td>Delay between two animation phases. If Delay = 0 one randomly chosen phase is permanently displayed.</td>
</tr>
<tr class="dark">
<td>Repeats</td>
<td>Integer</td>
<td>Number of animation runs until the particle is destroyed.</td>
</tr>
<tr>
<td>Reverse</td>
<td>Integer</td>
<td>0 or 1. If 1 every seconds animation is played backwards.</td>
</tr>
<tr class="dark">
<td>FadeOutLen</td>
<td>Integer</td>
<td>If specified, this number of animation phases is truncated from the end and reserved for a death animation which is displayed after all repetitions of the standard animation.</td>
</tr>
<tr>
<td>FadeOutDelay</td>
<td>Integer</td>
<td>Delay between two animation phases of the death animation.</td>
</tr>
<tr class="dark">
<td>RByV</td>
<td>Integer</td>
<td>0 to 3. 0 for no particle rotation. If 1 the particle will be aligned to its direction of travel; the particle's up-side will be in front. If 2 the speed parameters only determine rotation; the particle will not move. If 3 a random rotation is applied (from 4.9.8.0).</td>
</tr>
<tr>
<td>GravityAcc</td>
<td>Integer</td>
<td>Effects of gravity. At 0 the particle is not affected by gravity, at 100 it is fully affected. Negative values are also possible.</td>
</tr>
<tr class="dark">
<td>WindDrift</td>
<td>Integer</td>
<td>Horizontal drift by wind. Same as the material property of the same name. Since CR 4.9.8.4.</td>
</tr>
<tr>
<td>VertexCount</td>
<td>Integer</td>
<td>0 or 1. If 1, <a href="#collision">collision detection</a> is done.</td>
</tr>
<tr class="dark">
<td>VertexY</td>
<td>Integer</td>
<td>Y offset of the collision checking point in percent. Also see <a href="#collision">collision detection</a>.</td>
</tr>
<tr>
<td>Additive</td>
<td>Integer</td>
<td>0 or 1. If 1, the particle is drawn additively.</td>
</tr>
<tr class="dark">
<td>AlphaFade</td>
<td>Integer</td>
<td>0 to 40. Rate of fade out per frame. A fully faded particle is removed.</td>
</tr>
<tr>
<td>Parallaxity</td>
<td>2 Integer</td>
<td>Parallaxity in x and y directions. 0 is locked with the viewport; 100 is default (locked with the landscape).</td>
</tr>
<tr class="dark">
<td>Attach</td>
<td>Integer</td>
<td>0 or 1. If 1 the particle is moving relative to its target object's position. From CE 4.95.4.</td>
</tr>
</tbody>
</table></div>
	
	<h2 id="attributes">Properties</h2>
	<div class="text">Each particle has a position (x, y), horizontal and vertical impulse (xdir and ydir), life time (life), and two extra parameters (a and b). These are initialized by script and then processed by the <a href="#funcs">particle functions</a>. For more information see <a href="#funcs">particle functions</a> and <a href="#drawfuncs">drawing functions</a>.</div>
	
	<h2 id="face">Graphics</h2>
	<div class="text">The coordinates for the source rectangle within Graphics.png of a particle are comparable to the Face entry in an object's <a href="../../sdk/definition/actmap.html">ActMap.txt</a>. The coordinates only specify the first animation phase. All following animation phases should be located on the right (with smoke also below) of the initial phase. The animation length is then automatically determined from the image size. For the drawing offset you should usually specify half the particle size. An offset 0/0 would cause the particle graphics to be drawn below actual particle position.</div>
	<div class="text">If Delay = 0, a random animation phase is chosen on startup and maintained. The particle will exist until is falls out of the landscape.</div>
	
	<h2 id="maxcount">Particle Amounts</h2>
	<div class="text">For each particle type a maximum count is defined which is then also adjusted by the configuration setting for effect levels in the graphics options. As soon as half of the maximum amount of particles is created, new particles are only created based on random selected and the closer you get to the maximum value, the smaller the chance of new particle generation. This ensures a smooth approach to the actual limit.</div>
	
	<h2 id="collision">Collision Detection</h2>
	<div class="text">Particles can collide with the landscape. This is not very exact, however. Fast moving particles might pass through very thin layers of solid materials. If you need more precision, you should use objects instead.</div>
	<div class="text">Collision detection is only done in StdExec (i.e. not with smoke particles). For valid functions see <a href="#funcs">particle functions</a>. Collision detection is done at the particle center and only if VertexCount is specified. The point of detection can be shifted using VertexY. The specified values are in percent of the particle size, meaning VertexY=100 would check at the bottom of the particle. The visual size specified in Face doesn't affect this.</div>
	
	<h2 id="funcs">Particle Functions</h2>
	<div class="text">The behaviour of particles can be controlled by predefined particle functions. These are executed for initialization, then at each fram, and in case of <a href="#collision">collision</a> with the landscape.</div>

	<dl>
<dt id="stdexec">StdExec</dt>
<dd><div class="text">Standard function ExecFn for almost all particle types. The particle runs through an animation defined by Face, Delay, Repeats, Reverse, FadeOutLen, and FadeOutDelay and is then destroyed. The extra parameter defines the size of the particle in 1/10 pixels. b defines color modulation; if b = 0 no modulation is applied. aa as well as b are not modified by this function and will preserve the <a href="#control">initial</a> values. Also, the particle moves according to xdir and ydir while ydir is affected by gravity if GravityAcc is enabled.</div></dd>
<dt id="stdinit">StdInit</dt>
<dd><div class="text">Standard function for InitFn to be used with StdExec.</div></dd>
<dt id="bounce">Bounce</dt>
<dd><div class="text">Collision function: the particle will bounce back into the exact opposite direction.</div></dd>
<dt id="bouncey">BounceY</dt>
<dd><div class="text">Collision function: the particle will bounce back vertically.</div></dd>
<dt id="stop">Stop</dt>
<dd><div class="text">Collision function: the particle will stop.</div></dd>
<dt id="die">Die</dt>
<dd><div class="text">Collision function: the particle will be destroyed.</div></dd>
<dt id="smokeexec">SmokeExec</dt>
<dd><div class="text">Hard coded processing function for smoke particles. a is puff size; b is color modulation. Smoke graphics must be defined in 4 x 4 animation phases in Graphics.png of which the one on the lower right is used only rarely. The other animation phases are used evenly. Smoke always rises continuously until it collides with the landscape. If the life time has passed, the smoke particle fades out until it is deleted.</div></dd>
<dt id="smokeinit">SmokeInit</dt>
<dd><div class="text">Hard coded initialization function for smoke to be used in conjunction with SmokeExec.</div></dd>
</dl>
	
	<h2 id="drawfuncs">Drawing Functions</h2>
	<div class="text">Functions that can be assigned to DrawFn.</div>
		
	<dl>
<dt id="drawstd">Std</dt>
<dd><div class="text">Standard function for most particles except smoke. The particle is drawn at position x/y with size a/5 x a/5 and color modulated with b.</div></dd>
<dt id="drawsmoke">Smoke</dt>
<dd><div class="text">Drawing function for smoke.</div></dd>
</dl>
	
	<h2 id="control">Control</h2>
	<div class="text">External control of particles is very limited and only allows creation, global offset, and global removal. This is necessary as particles are not synchronized on computers throughout a network game and any deviation in particle handling would cause sync loss. Particles are created using <a href="../../sdk/script/fn/CreateParticle.html">CreateParticle</a>.</div>


<div class="author">Sven2, April 2002</div>

<?php 
  pwn_body(basename (dirname(__FILE__)) . basename(__FILE__,".html"), $_SERVER['SCRIPT_NAME']);
?><ul class="nav">
<li class="fineprint">Clonk Developer Mode Documentation</li>
<li class="switchlang"><a href="javascript:switchLanguage()"><img src="/deco/dco_de_sml.gif" alt="German" border="0"></a></li>
<li><a href="../../sdk/index.html">Introduction</a></li>
<li><a href="../../content.html">Contents</a></li>
<li><a href="../../search.php">Search</a></li>
<li><a href="../../sdk/console.html">Engine</a></li>
<li><a href="../../sdk/cmdline.html">Command Line</a></li>
<li><a href="../../sdk/files.html">Game Data</a></li>
<li><a href="../../sdk/script/index.html">Script</a></li>
</ul>
</body>
</html>
