<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<link rel="stylesheet" type="text/css" href="../../../doku.css">
<title>AddMenuItem</title>
<?php 
  $g_page_language = 'german';
  require_once('../../../../webnotes/core/api.php');
  pwn_head();
?><script type="text/javascript">
  function switchLanguage() {
    var loc = window.location.href;
    if (loc.match(/\/en\//)) loc = loc.replace(/\/en\//, "/de/");
    else loc = loc.replace(/\/de\//, "/en/");
    window.location = loc;
  }
</script>
</head>
<body>
<ul class="nav">
<li class="fineprint">Clonk Entwicklermodus Dokumentation</li>
<li class="switchlang"><a href="javascript:switchLanguage()"><img src="/deco/dco_en_sml.gif" alt="English" border="0"></a></li>
<li><a href="../../../sdk/index.html">Einleitung</a></li>
<li><a href="../../../content.html">Inhalt</a></li>
<li><a href="../../../search.php">Suche</a></li>
<li><a href="../../../sdk/console.html">Engine</a></li>
<li><a href="../../../sdk/cmdline.html">Kommandozeile</a></li>
<li><a href="../../../sdk/files.html">Spieldaten</a></li>
<li><a href="../../../sdk/script/index.html">Script</a></li>
</ul>
<h1 id="AddMenuItem">AddMenuItem</h1>
<div class="text">
<b>Kategorie: </b>Objekte
    / Menü<br><b>Ab Engineversion: </b>4.6.5.0 CP
        (erweitert ab 4.9.5.0 CE)
      </div>
<h2>Beschreibung</h2>
<div class="text">Fügt einen Menüeintrag hinzu.</div>
<h2>Syntax</h2>
<div class="text fnsyntax">
<span class="type">int</span> AddMenuItem
      (<span class="type">string</span> szCaption, <span class="type">string</span> szCommand, <span class="type">id</span> idItem, <span class="type">object</span> pMenuObject, <span class="type">int</span> iCount, <span class="type">int</span> iParameter, <span class="type">string</span> szInfoCaption, <span class="type">int</span> iExtra, <span class="type">any</span> XPar1, <span class="type">any</span> XPar2);
    </div>
<h2>Parameter</h2>
<dl>
<dt>szCaption: </dt>
<dd><div class="text">Text des neuen Menüeintrags</div></dd>
<dt>szCommand: </dt>
<dd><div class="text">Kommando, das bei Auswahl des Menüeintrags ausgeführt werden soll. Kann entweder ein Funktionsname oder ein Statement sein. Wenn ein Funktionsname angegeben wird, dann wird die Funktion in dem Objekt aufgerufen, welches bei <a href="../../../sdk/script/fn/CreateMenu.html">CreateMenu</a> als pCommandObject übergeben wurde.</div></dd>
<dt>idItem: </dt>
<dd><div class="text">Die ID wird als Bild für den Menüeintrag verwendet. Der Name der Definition kann mit %s in szCaption verwendet werden. Außerdem wird die ID als erster Parameter an den Aufruf von szCommand übergeben, sofern dieser nur ein Funktionsname ist.</div></dd>
<dt>pMenuObject: </dt>
<dd><div class="text">Objekt, dessen Menü der Eintrag hinzugefügt werden soll. Kann bei lokalen Aufrufen 0 sein.</div></dd>
<dt>iCount: </dt>
<dd><div class="text">Gewünschte Zahl, die neben dem Menüeintrag angezeigt werden soll (ähnlich der Mengenanzeige im Aktivieren-Menü)</div></dd>
<dt>iParameter: </dt>
<dd><div class="text">Wird als 2. Parameter an die in szCommand angegebene Funktion übergeben (siehe Anmerkung)</div></dd>
<dt>szInfoCaption: </dt>
<dd><div class="text">Beschreibungstext des neuen Menüeintrags</div></dd>
<dt>iExtra: </dt>
<dd><div class="text">
    [opt]
  Zusatzparameter für das Verhalten des Menüeintrags.<br>
					Untere 7 Bits (0-127): Menüsymbol. Sie lassen sich nicht gleichzeitig verwenden.<br>
					0: Normal<br>
					C4MN_Add_ImgRank = 1: Rangsymbol. Bei angegebenem idItem wird ggf. die Rank.png der Definition genutzt. iCount gibt die Ranghöhe an<br>
					C4MN_Add_ImgIndexed = 2: Picturefacet, das um XPar1-fache Picturebreite nach rechts verschoben ist. Damit lassen sich mehrere Menüsymbole innerhalb einer Definition unterbringen.<br>
					C4MN_Add_ImgObjRank = 3: XPar1 gibt ein Objekt an, dessen Picture-Grafik mit Rang gezeichnet wird. Hat das Objekt keine Infosektion (und damit keinen Rang), so wird in Kontextmenüs dennoch ein entsprechender Leerraum gelassen. Ab CE.<br>
					C4MN_Add_ImgObject = 4: XPar1 gibt ein Objekt an, dessen Picture-Grafik gezeichnet wird. Ab CE.<br>
					C4MN_Add_ImgTextSpec = 5: Das Symbol wird in szCaption festgelegt und kann entweder eine normale ID, eine Portrait-Spezifikation in der Form "Portrait:CLNK::00ff00::1" oder eines der folgenden Symbole sein:<br>
					<table>
<thead><tr>
<th>Name</th>
<th>Beschreibung</th>
</tr></thead>
<tbody>
<tr>
<td>Ico:Locked</td>
<td>Passwortsymbol</td>
</tr>
<tr class="dark">
<td>Ico:League</td>
<td>Ligasymbol</td>
</tr>
<tr>
<td>Ico:GameRunning</td>
<td>Symbol für "Spiel läuft"</td>
</tr>
<tr class="dark">
<td>Ico:Lobby</td>
<td>Symbol für "Lobby"</td>
</tr>
<tr>
<td>Ico:RuntimeJoin</td>
<td>Symbol für "Laufzeitbeitritt erlaubt"</td>
</tr>
<tr class="dark">
<td>Ico:FairCrew</td>
<td>Symbol für "Faire Crew"</td>
</tr>
<tr>
<td>Ico:Settlement</td>
<td>Symbol für Siedlungspunkte</td>
</tr>
</tbody>
</table>
<br>
					C4MN_Add_ImgColor = 6: Die Besitzerfarbflächen im Symbol werden mit der in XPar1 angegebenen Farbe eingefärbt. <br><br>
					Zusätzliche Flags (können mit obrigen Bits kombiniert werden):<br>
					C4MN_Add_PassValue = 128: XPar2 wird als Wertangabe benutzt, und überschreibt die Standardangabe (Wert der Definition idItem). Siehe auch iExtra von <a href="../../../sdk/script/fn/CreateMenu.html">CreateMenu</a>.<br>
					C4MN_Add_ForceCount = 256: Wenn dieses Flag angegeben wird, wird auch ein iCount von 0 im Menü als Anzahl angezeigt (wie es zB. auch im Kaufmenü der Fall ist).<br>
					Bei dieser Gelegenheit sei auch erwähnt, dass intern der Wert C4MN_Item_NoCount = 12345678 verwendet wird, wenn dieses Flag nicht angegeben ist, aber iCount 0 ist. D.h. auch, dass in dem seltenen Fall, dass iCount mit 12345678 angegeben wird, keine Anzahl angezeigt wird. <br>
					C4MN_Add_ForceNoDesc = 512: Wenn dieses Flag angegeben wird, wird auf keinen Fall eine Beschreibung für den Menüeintrag angezeigt. Beschreibung (setzbar mit szInfoCaption) in dem Sinn, dass ein Tooltip angezeigt wird, wenn der Menüeintrag lange genug ausgewählt ist.</div></dd>
<dt>XPar1: </dt>
<dd><div class="text">
    [opt]
  Erster Zusatzparameter für iExtra.</div></dd>
<dt>XPar2: </dt>
<dd><div class="text">
    [opt]
  Zweiter Zusatzparameter für iExtra.</div></dd>
</dl>
<h2>Anmerkungen</h2>
<div class="text">Menüsymbole sollten optimalerweise die Größe 35x35 für normale Menüs, 16x16 für Kontextmenüs besitzen. Andernfalls wird unter Beibehaltung des Höhe/Breite-Verhältnisses so gestreckt, dass die längere Seite dieser Größe entspricht.</div>
<div class="text">Wird als szCommand-Parameter nur ein Funktionsname angegeben, werden folgende Parameter übergeben:
			<code>idItem, iParameter, bRight[, iValue]</code>
						wobei bRight angibt, ob der Menueintrag mit [Special2] bzw. der rechten Maustaste ausgewählt wurde.
						iValue wird nur übergeben, wenn das Bit 8 bei iExtra gesetzt wird und gibt den (überschriebenen) angezeigten Wert des ausgewählten Menüeintrags an.
		</div>
<h2>Beispiele</h2>
			<div class="example">
				<pre class="code"><i>/* Wird bei Doppelklick auf Graben aufgerufen */</i>
<b>func</b> Activate()
{
	<i>// Lokales Menü mit lokalen Kommandos erzeugen
</i>	CreateMenu(GetID());
	<i>// Menüeinträge erzeugen
</i>	AddMenuItem(<i class="string">"Hallo sagen"</i>, <i class="string">"SayHello"</i>, 0);
	AddMenuItem(<i class="string">"Zaubern"</i>, <i class="string">"DoMagic"</i>, 0);
	AddMenuItem(<i class="string">"Objekt erzeugen: %s"</i>, <i class="string">"CreateItem"</i>, ROCK);
	AddMenuItem(<i class="string">"Objekt erzeugen: %s"</i>, <i class="string">"CreateItem"</i>, FLNT);
}

<i>/* Diese Kommados werden vom Menü aufgerufen */</i>
<b>func</b> SayHello()
{
	Message(<i class="string">"Hallo"</i>,this());
}

<b>func</b> DoMagic()
{
	Sound(<i class="string">"Magic*"</i>);
	ObjectCall(CreateObject(MLGT,0,0),<i class="string">"Activate"</i>,this());
}

<b>func</b> CreateItem(<b>id</b> item)
{
	Sound(<i class="string">"Magic*"</i>);
	CreateContents(item);
}</pre>
				<div class="text">Menü für einen Spezialclonk.</div>
			</div>
			<div class="example">
				<pre class="code"><b>func</b> Activate(<b>object</b> clonk)
{
	<i>// Menü im Clonk mit lokalen Kommandos erzeugen
</i>	CreateMenu(GetID(), clonk, this());
	<i>// Menüeinträge erzeugen
</i>	AddMenuItem(Format(<i class="string">"%s Schrumpfen"</i>, GetName(clonk)), Format(<i class="string">"DoCon(-10,Object(%d))"</i>, ObjectNumber(%d)), 0, this(), 0, 0, <i class="string">"Eine Art Jungbrunnen."</i>, 4, clonk);
}</pre>
				<div class="text">Menü für ein Schrumpfobjekt.</div>
			</div>
		<div class="text">
<b>Siehe auch: </b><a href="../../../sdk/script/fn/CloseMenu.html">CloseMenu</a>, <a href="../../../sdk/script/fn/CreateMenu.html">CreateMenu</a>, <a href="../../../sdk/script/fn/SelectMenuItem.html">SelectMenuItem</a>, <a href="../../../sdk/script/fn/SetMenuDecoration.html">SetMenuDecoration</a>, <a href="../../../sdk/script/fn/SetMenuTextProgress.html">SetMenuTextProgress</a>
</div>
<div class="author">jwk, April 2002</div>
<?php 
  pwn_body(basename (dirname(__FILE__)) . basename(__FILE__,".html"), $_SERVER['SCRIPT_NAME']);
?><ul class="nav">
<li class="fineprint">Clonk Entwicklermodus Dokumentation</li>
<li class="switchlang"><a href="javascript:switchLanguage()"><img src="/deco/dco_en_sml.gif" alt="English" border="0"></a></li>
<li><a href="../../../sdk/index.html">Einleitung</a></li>
<li><a href="../../../content.html">Inhalt</a></li>
<li><a href="../../../search.php">Suche</a></li>
<li><a href="../../../sdk/console.html">Engine</a></li>
<li><a href="../../../sdk/cmdline.html">Kommandozeile</a></li>
<li><a href="../../../sdk/files.html">Spieldaten</a></li>
<li><a href="../../../sdk/script/index.html">Script</a></li>
</ul>
</body>
</html>
