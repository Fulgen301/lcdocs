<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<link rel="stylesheet" type="text/css" href="../../doku.css">
<title>Szenarioscripte</title>
<?php 
  $g_page_language = 'german';
  require_once('../../../webnotes/core/api.php');
  pwn_head();
?><script type="text/javascript">
  function switchLanguage() {
    var loc = window.location.href;
    if (loc.match(/\/en\//)) loc = loc.replace(/\/en\//, "/de/");
    else loc = loc.replace(/\/de\//, "/en/");
    window.location = loc;
  }
</script>
</head>
<body>
<ul class="nav">
<li class="fineprint">Clonk Entwicklermodus Dokumentation</li>
<li class="switchlang"><a href="javascript:switchLanguage()"><img src="/deco/dco_en_sml.gif" alt="English" border="0"></a></li>
<li><a href="../../sdk/index.html">Einleitung</a></li>
<li><a href="../../content.html">Inhalt</a></li>
<li><a href="../../search.php">Suche</a></li>
<li><a href="../../sdk/console.html">Engine</a></li>
<li><a href="../../sdk/cmdline.html">Kommandozeile</a></li>
<li><a href="../../sdk/files.html">Spieldaten</a></li>
<li><a href="../../sdk/script/index.html">Script</a></li>
</ul>


<h1 id="SzenarioScripte">Szenarioscripte</h1>

	<div class="text">In Szenarioscripten kann ein globaler Handlungsablauf und szenarienspezifische Besonderheiten wie Rejoins oder spezielle Spielerplatzierungen festgelegt werden. Für eine Beschreibung der Scriptsprache C4Script siehe <a href="../../sdk/script/index.html">C4Script</a>-Dokumentation.</div>

	<h2 id="Callbacks">Callbacks in Szenarioscripten</h2>
	<div class="text">Beim Start der Runde (Und VOR dem Beitritt der Spieler!) ruft die Engine, wenn vorhanden, die Funktion "Initialize" im Script des Szenarios auf. Innerhalb dieser Funktion können z.B. Objekte erzeugt werden, die beim Start der Runde vorhanden sein sollen. Außerdem kann die fortlaufende Scriptausführung gestartet werden.</div>

	<pre class="code"><b>func</b> Initialize()
{
  <a href="../../sdk/script/fn/Message.html">Message</a>(<i class="string">"Hallo"</i>); 
  <a href="../../sdk/script/fn/CreateObject.html">CreateObject</a>(HUT1,250,200,0);
  <a href="../../sdk/script/fn/ScriptGo.html">ScriptGo</a>(1);
}</pre>

	<div class="text">Fortlaufende Scriptausführung: zu Beginn der Runde steht der interne Sciptzähler auf 0. Wurde mit ScriptGo die Scriptausführung aktiviert, so erhöht die Engine im Lauf der Runde in jedem zehnten Frame (Bild) den Scriptzähler um 1 und ruft, wenn vorhanden, die dazugehörige Script-Funktion im Szenario-Script auf.</div>
	
	<pre class="code"><b>func</b> Script26()
{
  <a href="../../sdk/script/fn/Message.html">Message</a>(<i class="string">"Diese Funktion wird nach 260 Frames ausgeführt."</i>);
}</pre>

	<div class="text">Der Scriptzähler kann mit dem Befehl <a href="../../sdk/script/fn/goto.html">goto</a>() auch manuell auf einen bestimmten Wert gesetzt werden.</div>
	<div class="text">Nach der Platzierung eines beitretenden Spielers ruft die Engine, wenn vorhanden, die Funktion InitializePlayer im Scenario-Script für diesen Spieler auf. Die Funktion wird aufgerufen, nachdem die in Scenario.txt beschriebenen Startkonditionen (Positionierung und Platzierung von Mannschaft, Gebäude, Fahrzeuge, Material) verarbeitet wurden. Mit dieser Funktion können weitere spielerabhängige Startkonditionen geschaffen werden.</div>

	<pre class="code"><b>func</b> InitializePlayer(iPlr)
{
  <i>// Eine Meldung für diesen Spieler
</i>  <a href="../../sdk/script/fn/Message.html">Message</a>( <i class="string">"Spieler Nr. %d ist beigetreten"</i>, 0, iPlr );
  <a href="../../sdk/script/fn/Sound.html">Sound</a>(<i class="string">"Ding"</i>);
  <i>// Ersten Clonk des Spielers doch an einer anderen Stelle starten lassen
</i>  <a href="../../sdk/script/fn/SetPosition.html">SetPosition</a>( <a href="../../sdk/script/fn/Random.html">Random</a>(<a href="../../sdk/script/fn/LandscapeWidth.html">LandscapeWidth</a>()), <a href="../../sdk/script/fn/Random.html">Random</a>(<a href="../../sdk/script/fn/LandscapeHeight.html">LandscapeHeight</a>()), <a href="../../sdk/script/fn/GetCrew.html">GetCrew</a>(iPlr));
}</pre>

	<div class="text">Analog dazu ruft die Engine die Funktion RemovePlayer auf, wenn ein Spieler die Runde verlässt.</div>
	<div class="text">Wird eine Runde durch szenariobedingte Spielziele wie Spielereliminierung, Materialabbau, usw. (siehe Scenario.txt <a href="../../sdk/scenario/scenario.html#SektionGame">Sektion [Game]</a>) oder durch den Scriptbefehl GameOver beendet (also nicht bei abgebrochenen Runden), ruft die Engine im Szenario-Script die Funktion OnGameOver auf.</div>

	<pre class="code"><b>func</b> OnGameOver()
{
  <a href="../../sdk/script/fn/Sound.html">Sound</a>(<i class="string">"Trumpet"</i>);
  <i>// Hier bietet sich die Möglichkeit für spezielle Rundenauswertung in der Log-Datei Clonk4.log
</i>  <a href="../../sdk/script/fn/Log.html">Log</a>(<i class="string">"Vermögen von Spieler 1: %d"</i>, <a href="../../sdk/script/fn/GetWealth.html">GetWealth</a>(0));
}</pre>


<div class="author">Sven2, April 2002</div>

<?php 
  pwn_body(basename (dirname(__FILE__)) . basename(__FILE__,".html"), $_SERVER['SCRIPT_NAME']);
?><ul class="nav">
<li class="fineprint">Clonk Entwicklermodus Dokumentation</li>
<li class="switchlang"><a href="javascript:switchLanguage()"><img src="/deco/dco_en_sml.gif" alt="English" border="0"></a></li>
<li><a href="../../sdk/index.html">Einleitung</a></li>
<li><a href="../../content.html">Inhalt</a></li>
<li><a href="../../search.php">Suche</a></li>
<li><a href="../../sdk/console.html">Engine</a></li>
<li><a href="../../sdk/cmdline.html">Kommandozeile</a></li>
<li><a href="../../sdk/files.html">Spieldaten</a></li>
<li><a href="../../sdk/script/index.html">Script</a></li>
</ul>
</body>
</html>
